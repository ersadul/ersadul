6. Working with sets
# # set theory primer
- A union B
- A intersect B
- A except B
-- (A Union B) except (A intersect B)
-- (A except B) Union (B except A)


# # Set Theory in Practice

mysql> SELECT 1 num, 'abc' str
 -> UNION
 -> SELECT 9 num, 'xyz' str;
 
 
# # Set Operators
# The union Operator
mysql> SELECT 'CUST' typ, c.first_name, c.last_name
 -> FROM customer c
 -> UNION ALL
 -> SELECT 'ACTR' typ, a.first_name, a.last_name
 -> FROM actor a;

Union:
MariaDB [sakila]> select first_name, last_name from actor WHERE first_name LIKE 'J%' AND last_name LIKE 'D%'
    -> union
    -> select first_name, last_name from actor WHERE first_name LIKE 'J%' AND last_name LIKE 'D%';

Union all:
MariaDB [sakila]> select first_name, last_name from actor WHERE first_name LIKE 'J%' AND last_name LIKE 'D%'
    -> union all
    -> select first_name, last_name from actor WHERE first_name LIKE 'J%' AND last_name LIKE 'D%';
	
	
# The intersect Operator
MariaDB [sakila]> select first_name, last_name from actor WHERE first_name LIKE 'J%' AND last_name LIKE 'D%'
    -> intersect
    -> select first_name, last_name from customer WHERE first_name LIKE 'J%' AND last_name LIKE 'D%';


# The except Operator
except is invers of intersect
MariaDB [sakila]> select first_name, last_name from actor WHERE first_name LIKE 'J%' AND last_name LIKE 'D%'
    -> except
    -> select first_name, last_name from customer WHERE first_name LIKE 'J%' AND last_name LIKE 'D%';


# # Set Operation Rules
# Sorting Compound Query Results
if we want to sort the result where we do union all, we must specify the columns alias
MariaDB [sakila]> select a.first_name fname, a.last_name lname
    -> from actor a
    -> where a.first_name like 'J%' AND a.last_name like 'D%'
    -> union all
    -> select c.first_name, c.last_name
    -> from customer c
    -> where c.first_name like 'J%' and c.last_name like "D%"
    -> order by lname, fname;


# Set Operation Precedence


# # Exercise 6
# Exercise 6-1
If set A = {L M N O P} and set B = {P Q R S T}, what sets are generated by the follow‐
ing operations?
• A union B: L M N O P Q R S T
• A union all B: L M N O P P Q R S T
• A intersect B: P
• A except B: L M N O


# Exercise 6-2
Write a compound query that finds the first and last names of all actors and custom‐
ers whose last name starts with L.
MariaDB [sakila]> select a.first_name, a.last_name
    -> from actor a where a.last_name like 'L%'
    -> union
    -> select c.first_name, c.last_name
    -> from customer c where c.last_name like 'L%';


# Exercise 6-3
Sort the results from Exercise 6-2 by the last_name column.
MariaDB [sakila]> select a.first_name fname, a.last_name lname
    -> from actor a where a.last_name like 'L%'
    -> union
    -> select c.first_name, c.last_name
    -> from customer c where c.last_name like 'L%'
    -> order by lname;
	
